# testing unpack 2
# with checksum validation and ACK/NAK handling
# for Message
import swp_unpack as unpack
import swp_message as message

if __name__ == '__main__':
    chunk = b'\x10\x06\x10\x02\x04\x00\x00\x00\n\x05\xed\x10\x03\x10\x06\x10\x06\x10\x06\x10\x06\x10\x06\x10\x06\x10' \
             b'\x06\x10\x06\x10\x06\x10\x02\x04\x00\x00\x01\x0b\x05\xeb\x10\x03\x10\x02\x04\x00\x00\x02\x0c\x05\xe9\x10' \
             b'\x03\x10\x02\x04\x00\x00\x03\r\x05\xe7\x10\x03\x10\x02\x04\x00\x00\x04\x0e\x05\xe5\x10\x03\x10\x02\x04' \
             b'\x00\x00\x05\x0f\x05\xe3\x10\x03\x10\x02\x04\x00\x00\x06\x10\x10\x05\xe1\x10\x03\x10\x02\x04\x00\x00\x07' \
             b'\x11\x05\xdf\x10\x03\x10\x02\x04\x00\x00\x08\x12\x05\xdd\x10\x03\x10\x02\x04\x00\x00\t\x13\x05\xdb\x10' \
             b'\x03 '

    messages, residual_data = unpack.unpack_data(chunk)

    for msg in messages:
        msg = message.Message.decode(msg)
        print(msg)

    print("residual data = ", residual_data)
    print(len(messages), "messages unpacked")
